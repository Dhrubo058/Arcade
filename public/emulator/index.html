<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Neo Geo Emulator</title>

<style>
html,body{
margin:0;
background:black;
height:100%;
overflow:hidden;
font-family: sans-serif;
}

#game{
width:100%;
height:100%;
}

#loading {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #10b981;
  font-weight: 900;
  font-style: italic;
  letter-spacing: -0.05em;
  font-size: 24px;
  text-transform: uppercase;
}
</style>

</head>

<body>

<div id="loading">Initializing System...</div>
<div id="game"></div>

<script>

function getParam(name){
 const params = new URLSearchParams(window.location.search);
 return params.get(name);
}

const rom = getParam("rom");

// EmulatorJS Configuration
window.EJS_player = "#game";
window.EJS_core = "fbneo"; // Core set to FBNeo
window.EJS_gameName = rom ? rom.replace('.zip', '') : "Unknown";
window.EJS_color = "#10b981";
window.EJS_startOnLoaded = true;

// Arcade Romset Compatibility Mode
window.EJS_arcade = true; 

window.EJS_pathtodata = "https://cdn.emulatorjs.org/stable/data/";

// Load ROM exactly as uploaded
window.EJS_gameUrl = "/roms/" + rom;

// BIOS Configuration
// We try to load from /roms/ first, then /bios/ as a fallback.
// For Neo Geo, neogeo.zip is mandatory.
window.EJS_biosUrl = "/roms/neogeo.zip"; 

// Hide loading text when emulator starts
window.EJS_onGameStart = function() {
  document.getElementById('loading').style.display = 'none';
};

// Check if /roms/neogeo.zip exists, if not use /bios/neogeo.zip
fetch('/roms/neogeo.zip', { method: 'HEAD' })
  .then(res => {
    if (!res.ok) {
      window.EJS_biosUrl = "/bios/neogeo.zip";
    }
    loadEmulator();
  })
  .catch(() => {
    window.EJS_biosUrl = "/bios/neogeo.zip";
    loadEmulator();
  });

function loadEmulator() {
  const script = document.createElement('script');
  script.src = "https://cdn.emulatorjs.org/stable/data/loader.js";
  document.body.appendChild(script);
}

</script>

</body>
</html>
